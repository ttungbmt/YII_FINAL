{"version":3,"sources":["app/main/maps/ContainerProvider.js","app/layouts/map/partials/Main/Sidebar/Layout.js","app/main/maps/Container.js"],"names":["ContainerContext","React","createContext","initForm","key","url","page","values","data","filter","fields","initialState","show","loading","forms","caseReducer","setLoading","state","payload","createForm","props","nextPage","prevPage","setShow","setFormData","setFormValues","setFormFields","refreshData","reducer","draft","action","type","memo","children","useImmerReducer","dispatch","actions","mapValues","v","fetchFn","acts","fetchData","form","params","axios","get","then","fetchColumns","p","columns","fetchForm","options","callback","post","pick","useFetch","value","getForm","Provider","Title","title","icon","back","rightTitle","history","useHistory","className","onClick","isBoolean","goBack","push","subTitle","content","useSlot","size","order","Box","display","alignItems","height","id","scrollable","route","auth","useSelector","authSel","getAuth","defaultValues","maquan","user","maphuong","ContainerProvider","renderRoutes","routes","SidebarLayout","Template"],"mappings":"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","file":"static/js/16.chunk.js","sourcesContent":["import React, { memo } from 'react'\r\nimport { useImmerReducer } from 'use-immer'\r\nimport { mapValues, get, pick } from '@ttungbmt/utils'\r\nimport axios from 'axios'\r\n\r\nexport const ContainerContext = React.createContext()\r\n\r\nconst initForm = {\r\n    key: null,\r\n    url: '',\r\n    page: 1,\r\n    values: {},\r\n    data: {},\r\n    filter: '',\r\n    fields: []\r\n}\r\n\r\nconst initialState = {\r\n    show: false,\r\n    loading: false,\r\n    forms: {\r\n\r\n    }\r\n}\r\n\r\nconst caseReducer = {\r\n    setLoading: (state, payload) => {\r\n        state.loading = payload\r\n    },\r\n    createForm: (state, {key, ...props}) => {\r\n        if(!state.forms[key]) {\r\n            state.forms[key] = {...initForm, key, ...props}\r\n        }\r\n    },\r\n    nextPage: (state, {key, ...props}) => {\r\n        state.forms[key].page = state.forms[key].page + 1\r\n    },\r\n    prevPage: (state, {key, ...props}) => {\r\n        state.forms[key].page = state.forms[key].page === 1 ? 1 : state.forms[key].page -1\r\n    },\r\n    setShow: (state, payload) => {\r\n        state.show = payload\r\n    },\r\n    setFormData: (state, {key, data}) => {\r\n        if(key && data) state.forms[key] = {...state.forms[key], ...data}\r\n    },\r\n    setFormValues: (state, {key, values}) => {\r\n        if(state.forms[key]) {\r\n            state.forms[key].values = values\r\n        } else {\r\n            state.forms[key] = {...initForm, key, values}\r\n        }\r\n    },\r\n    setFormFields: (state, {key, fields}) => {\r\n        state.forms[key].fields = fields\r\n    },\r\n    refreshData: (state, {key}) => {\r\n        state.forms[key].page = 1\r\n        state.forms[key].values = {}\r\n    },\r\n}\r\n\r\nconst reducer = (draft, action) => caseReducer[action.type] && caseReducer[action.type](draft, action.payload)\r\n\r\nfunction useFetch({actions: acts}) {\r\n    const fetchData = ({form}) => {\r\n        if(form) {\r\n            acts.setLoading(true)\r\n            let params = {\r\n                ...form.values,\r\n                page: form.page,\r\n            }\r\n            axios.get(form.url, {params}).then(({data}) => {\r\n                acts.setFormData({key: form.key, data})\r\n                acts.setLoading(false)\r\n            })\r\n        }\r\n    }\r\n\r\n    const fetchColumns = (p) => {\r\n        acts.setLoading(true)\r\n        axios.get(`${p.url}?columns`).then(({data}) => {\r\n            acts.createForm({\r\n                key: p.key,\r\n                url: p.url,\r\n                columns: data.columns,\r\n                filter: data.form\r\n            })\r\n        })\r\n    }\r\n\r\n    const fetchForm = ({form, values}, options, callback) => {\r\n        if(form) {\r\n            acts.setLoading(true)\r\n            axios.post(form.url, values).then(({data}) => {\r\n                acts.setFormData({key: form.key, data})\r\n                callback && callback(data)\r\n                acts.setLoading(false)\r\n            })\r\n        }\r\n    }\r\n\r\n    const refreshData = (p) => fetchData({form: {\r\n        ...pick(p.form, ['key', 'url']),\r\n        page: 1,\r\n    }})\r\n\r\n    return {fetchColumns, fetchData, fetchForm, refreshData}\r\n}\r\n\r\nfunction ContainerProvider({children}) {\r\n    const [state, dispatch] = useImmerReducer(reducer, initialState)\r\n    const actions = mapValues(caseReducer, (v, type) => (payload) => dispatch({type, payload }))\r\n    const fetchFn = useFetch({actions})\r\n\r\n    const value = {\r\n        ...state,\r\n        actions: {\r\n            ...actions,\r\n            ...fetchFn,\r\n        },\r\n        getForm: (key) => get(state, `forms.${key}`, {}),\r\n    }\r\n\r\n    return (\r\n        <ContainerContext.Provider value={value}>\r\n            {children}\r\n        </ContainerContext.Provider>\r\n    )\r\n}\r\n\r\nexport default memo(ContainerProvider)","import React, { memo } from 'react'\r\nimport { useHistory } from \"react-router-dom\"\r\nimport * as Space from \"react-spaces\"\r\nimport { useSlot } from \"@ttungbmt/redux-layout\"\r\nimport Box from '@material-ui/core/Box'\r\nimport { isBoolean } from '@ttungbmt/utils'\r\n\r\nfunction Title({title, icon, back, rightTitle}) {\r\n    let history = useHistory()\r\n\r\n    return (\r\n        <>\r\n            {back ? (\r\n                <a className=\"cursor-pointer\" onClick={() => isBoolean(back) ? history.goBack() : history.push(back)}>\r\n                    <i className=\"icon-arrow-left52 ml-2\"/>\r\n                </a>\r\n            ) : (\r\n                <span className=\"badge bg-blue-400 ml-2\">{icon ? (<i className={icon}/>) : '#'}</span>\r\n            )}\r\n\r\n            <span className=\"ml-2\">{title}</span>\r\n            {rightTitle}\r\n        </>\r\n    )\r\n}\r\n\r\n\r\nfunction SidebarLayout({children, subTitle, content, ...props}) {\r\n    const [Slot] = useSlot(children)\r\n\r\n    return (\r\n        <Space.Fill>\r\n            <Space.Top size={45} order={1}>\r\n                <Box display=\"flex\" alignItems=\"center\" height=\"100%\" className=\"sb-title text-uppercase\">\r\n                    <Title {...props}/>\r\n                </Box>\r\n            </Space.Top>\r\n            {subTitle && (\r\n                <Space.Top size={36} order={2}>\r\n                    <Box display=\"flex\" height=\"100%\" className=\"sb-sub-title\">\r\n                        {subTitle}\r\n                        {/*<Slot name=\"subTitle\"/>*/}\r\n                    </Box>\r\n                </Space.Top>\r\n            )}\r\n            <Space.Fill id=\"sb-body\" scrollable={true}>\r\n                {content}\r\n                {/*<Slot name=\"content\"/>*/}\r\n            </Space.Fill>\r\n\r\n        </Space.Fill>\r\n    )\r\n}\r\n\r\nexport default memo(SidebarLayout)","import React, { memo  } from 'react'\r\nimport { renderRoutes } from 'react-router-config'\r\nimport SidebarLayout from 'app/layouts/map/partials/Main/Sidebar/Layout'\r\nimport { Template } from '@ttungbmt/redux-layout'\r\nimport { useSelector } from '@ttungbmt/redux-toolkit'\r\nimport ContainerProvider from './ContainerProvider'\r\nimport { selectors as authSel } from \"@core/reducers/auth\"\r\n\r\nfunction MapsContainer({children, route, ...props}) {\r\n    const auth = useSelector(authSel.getAuth)\r\n    const defaultValues = {\r\n        maquan: auth.user.maquan,\r\n        maphuong: auth.user.maphuong,\r\n    }\r\n\r\n    return (\r\n        <ContainerProvider>\r\n            {renderRoutes(route.routes, {\r\n                SidebarLayout, Template, defaultValues\r\n            })}\r\n        </ContainerProvider>\r\n    )\r\n}\r\n\r\nexport default memo(MapsContainer)\r\n\r\n"],"sourceRoot":""}