{"version":3,"sources":["webpack:///./modules/react-map/app/map/WMSTileLayer.js?028a"],"names":["WMSTileLayer","props","url","layerID","L","TileLayer","BetterWMS","WMS","extend","onAdd","map","prototype","call","on","getFeatureInfo","onRemove","off","evt","getFeatureInfoUrl","latlng","showResults","Util","bind","showGetFeatureInfo","$","ajax","success","data","status","xhr","err","error","point","_map","latLngToContainerPoint","getZoom","size","getSize","params","request","service","srs","styles","wmsParams","transparent","version","format","bbox","getBounds","toBBoxString","height","y","width","x","layers","query_layers","cql_filter","env","viewparams","info_format","_url","getParamString","tileLayer","betterWms","options","leafletElement","wms","propTypes","string","isRequired","func","defaultProps"],"mappings":"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","file":"0.ba5b402c3074544600e7.hot-update.js","sourcesContent":["/* @flow */\n\nimport {PropTypes} from 'react'\n\nimport BaseTileLayer from './BaseTileLayer'\n\nexport default class WMSTileLayer extends BaseTileLayer {\n    static propTypes = {\n        url: PropTypes.string.isRequired,\n        layers: PropTypes.string.isRequired,\n        showGetFeatureInfo: PropTypes.func,\n    };\n\n    static defaultProps = {\n        format: 'image/png',\n    };\n\n\n    componentWillMount() {\n        super.componentWillMount()\n        const {url, layerID, ...props} = this.props;\n\n\n        L.TileLayer.BetterWMS = L.TileLayer.WMS.extend({\n\n            onAdd: function (map) {\n                // Triggered when the layer is added to a map.\n                //   Register a click listener, then do all the upstream WMS things\n                L.TileLayer.WMS.prototype.onAdd.call(this, map);\n                map.on('click', this.getFeatureInfo, this);\n            },\n\n            onRemove: function (map) {\n                // Triggered when the layer is removed from a map.\n                //   Unregister a click listener, then do all the upstream WMS things\n                L.TileLayer.WMS.prototype.onRemove.call(this, map);\n                map.off('click', this.getFeatureInfo, this);\n            },\n\n            getFeatureInfo: function (evt) {\n                // Make an AJAX request to the server and hope for the best\n                var url = this.getFeatureInfoUrl(evt.latlng),\n                    showResults = L.Util.bind(this.showGetFeatureInfo, this);\n                $.ajax({\n                    url: url,\n                    success: function (data, status, xhr) {\n                        var err = typeof data === 'string' ? null : data;\n                        showResults(err, evt.latlng, data);\n                    },\n                    error: function (xhr, status, error) {\n                        showResults(error);\n                    }\n                });\n            },\n\n            getFeatureInfoUrl: function (latlng) {\n                // Construct a GetFeatureInfo request URL given a point\n                var point = this._map.latLngToContainerPoint(latlng, this._map.getZoom()),\n                    size = this._map.getSize(),\n\n                    params = {\n                        request: 'GetFeatureInfo',\n                        service: 'WMS',\n                        srs: 'EPSG:4326',\n                        styles: this.wmsParams.styles,\n                        transparent: this.wmsParams.transparent,\n                        version: this.wmsParams.version,\n                        format: this.wmsParams.format,\n                        bbox: this._map.getBounds().toBBoxString(),\n                        height: size.y,\n                        width: size.x,\n                        layers: this.wmsParams.layers,\n                        query_layers: this.wmsParams.layers,\n                        cql_filter: this.wmsParams.cql_filter,\n                        env: this.wmsParams.env,\n                        viewparams: this.wmsParams.viewparams,\n                        info_format: 'application/json'\n                    };\n\n                params[params.version === '1.3.0' ? 'i' : 'x'] = point.x;\n                params[params.version === '1.3.0' ? 'j' : 'y'] = point.y;\n\n                return this._url + L.Util.getParamString(params, this._url, true);\n            },\n\n            showGetFeatureInfo: props.showGetFeatureInfo\n        });\n\n        L.tileLayer.betterWms = function (url, options) {\n            return new L.TileLayer.BetterWMS(url, options);\n        };\n\n\n        this.leafletElement = props.showGetFeatureInfo ? L.tileLayer.betterWms(url, props) : L.tileLayer.wms(url, props);\n        this.leafletElement.layerID = layerID ? layerID : null;\n\n\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./modules/react-map/app/map/WMSTileLayer.js"],"sourceRoot":""}